---
output: html_document
---
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ

–≤–∫–ª—é—á–∞–µ–º –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```r
library("dplyr")
library("lubridate")
library("ggplot2")
library("lattice")
library("car")
```

## –æ–± –∏—Å—Ç–æ—á–Ω–∏–∫–µ –¥–∞–Ω–Ω—ã—Ö
*–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö* - [pogoda.by](http://pogoda.by/zip/index.php?Year=2015#csv)  
*–¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏*: 15/10/2015  
*–ª–æ–∫–∞—Ü–∏—è*: –¥–∞–Ω–Ω—ã–µ —Å–∫–∞—á–∞–Ω—ã –¥–ª—è –≥–æ—Ä–æ–¥–∞ –ú–∏–Ω—Å–∫–∞ (—Å–º. —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ —Å—Å—ã–ª–∫–µ —Å 
–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º "‚Ññ –í–ú–û" = 26850)  
*–ø–µ—Ä–∏–æ–¥* —è–Ω–≤2006-—Å–µ–Ω2015–≥  
*–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤* –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –æ–¥–Ω–æ–π –º–µ—Ç–µ–æ—Å—Ç–∞–Ω—Ü–∏–∏ –∑–∞ 
–º–µ—Å—è—Ü. –î–∏—Å–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å –º–µ—Ç–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–π 3 —á–∞—Å–∞. –í —Ñ–∞–π–ª–µ –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞) 
‚Äî —ç—Ç–æ –æ–¥–∏–Ω —Å—Ä–æ–∫ –º–µ—Ç–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–π. –ú–µ—Ç–µ–æ–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å—Ç—Ä–æ–∫–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Ç–æ—á–∫–æ–π —Å 
–∑–∞–ø—è—Ç–æ–π. –û—Ç–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–æ–π —á–∞—Å—Ç–∏ —á–∏—Å–ª–∞ –æ—Ç –¥—Ä–æ–±–Ω–æ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π.  
*–æ–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —Å—Ç–æ–ª–±—Ü–∞–º)*:   
1. —á–∏—Å–ª–æ –º–µ—Å—è—Ü–∞;  
2. —Å—Ä–æ–∫ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π [—á–∞—Å—ã], UTC;  
3. T - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ 2 –º [–¶–µ–ª—å—Å–∏—è];  
4. dd - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ 10 –º [—Ä—É–º–±—ã, –æ—Ç–∫—É–¥–∞ –¥—É–µ—Ç];    
5. FF - —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ 10 –º [–º/—Å];  
6. ww - –∫–æ–¥ –ø–æ–≥–æ–¥—ã –≤ —Å—Ä–æ–∫ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è [CL - –±–µ–∑ —è–≤–ª–µ–Ω–∏–π, BR - –¥—ã–º–∫–∞, FG - —Ç—É–º–∞–Ω, 
RA - –¥–æ–∂–¥—å SHRA - –ª–∏–≤–Ω–µ–≤—ã–π –¥–æ–∂–¥—å, SNRA - —Å–Ω–µ–≥ —Å –¥–æ–∂–¥–µ–º, SN - —Å–Ω–µ–≥, SHSN - 
–ª–∏–≤–Ω–µ–≤—ã–π —Å–Ω–µ–≥, TS - –≥—Ä–æ–∑–∞, DZ - –º–æ—Ä–æ—Å—å, FZ - –≥–æ–ª–æ–ª–µ–¥, HL - –≥—Ä–∞–¥];  
7. N - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–ª–∞–∫–æ–≤ [0 - —è—Å–Ω–æ, 1 - –º–∞–ª–æ–æ–±–ª–∞—á–Ω–æ (1-2 –±–∞–ª–ª–∞), 3 - –Ω–µ–±–æ–ª—å—à–∞—è 
–æ–±–ª–∞—á–Ω–æ—Å—Ç—å (3-4), 6 - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è (5-7 –±–∞–ª–ª–æ–≤), 7 - –æ–±–ª. —Å –ø—Ä–æ—è—Å–Ω–µ–Ω–∏—è–º–∏ (8-9), 9 
- —Å–ø–ª–æ—à–Ω–∞—è (10 –±–∞–ª–ª–æ–≤)];  
8. vv - –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ [–∫–º];  
9. U - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞ [%];   
10. PPP - –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ—Ä—è [–≥—ï–∞].  

## –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª

```r
test <- read.csv('./Raw data/26850_2006-01.csv', sep = ';', header = F)
head(test)
```

```
##   V1 V2   V3    V4 V5 V6 V7 V8 V9  V10
## 1  1  0 -4.3 ﬁÊÌ˚È  3 CL  3 10 84 1016
## 2  1  3 -4.7   ﬁ-¬  3 CL  1 10 86 1017
## 3  1  6 -4.8   ﬁ-¬  2 CL  3 10 83 1018
## 4  1  9 -3.3 ﬁÊÌ˚È  3 CL  9 10 81 1020
## 5  1 12 -1.1 ﬁÊÌ˚È  3 CL  6 10 72 1020
## 6  1 15 -1.5 ﬁÊÌ˚È  3 CL  6 10 68 1021
```

–ì–æ—Ç–æ–≤–∏–º dataframe `weather` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤, –¥–æ–±–∞–≤–ª—è–µ–º —Ç—É–¥–∞ 
–ø–µ—Ä–≤—ã–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤–ª—è–µ–º 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ `year` –∏ `month` 
–¥–ª—è –∑–∞–ø–∏—Å–∏ –≥–æ–¥–∞ –∏ –º–µ—Å—è—Ü–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (—ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –±–µ—Ä–µ–º –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞)

```r
files <- list.files(path = "./Raw data/", pattern = ".*csv")
weather <- test
weather <- weather[1,1:10]
weather <- cbind(weather, "year", "month")
weather <- weather[FALSE,]
```

–°–∫–∞—á–∏–≤–∞–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –∏ –ø–∞—Ä—Å–∏–º –≥–æ–¥ –∏ –º–µ—Å—è—Ü –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

```r
for (i in 1:length(files)) {
  tyear <- gsub(pattern = "([0-9]{5}_)|(-\\d{1,2}\\.csv)", x=files[i], replacement = "")
  tmonth <- gsub(pattern = "([0-9]{5}_[0-9]{4}-(0)?)|(.csv)", x=files[i], replacement = "")
  temp <- read.csv(paste0("./Raw data/",files[i]), sep = ";", header = F)
  temp <- cbind(temp, "year", "month")
  temp[,11] <- rep(tyear, len = nrow(temp))
  temp[,12] <- rep(tmonth, len = nrow(temp))
  weather <- rbind(weather,temp)
}
```

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã

```r
names(weather) <- c("day", "hour", "tem", "windd", "winds", "rainy", "clowdly","vv", "humidity", "ppp", "year", "month")
```
–ò —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏–º–µ–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º

```r
head(weather)
```

```
##   day hour  tem windd winds rainy clowdly vv humidity  ppp year month
## 1   1    0 -4.3 ﬁÊÌ˚È     3    CL       3 10       84 1016 2006     1
## 2   1    3 -4.7   ﬁ-¬     3    CL       1 10       86 1017 2006     1
## 3   1    6 -4.8   ﬁ-¬     2    CL       3 10       83 1018 2006     1
## 4   1    9 -3.3 ﬁÊÌ˚È     3    CL       9 10       81 1020 2006     1
## 5   1   12 -1.1 ﬁÊÌ˚È     3    CL       6 10       72 1020 2006     1
## 6   1   15 -1.5 ﬁÊÌ˚È     3    CL       6 10       68 1021 2006     1
```

##–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

—Ñ—É–Ω–∫—Ü–∏—è `checkna` –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞.
–ö–∞–∫ –≤–∏–¥–∏–º, –ø–∞—Ä–∞–º–µ—Ç—Ä `clowdly` –∏–º–µ–µ—Ç 545 –∑–Ω–∞—á–µ–Ω–∏–π NA, –æ—Å—Ç–∞–ª—å–Ω—ã–µ - 4-8 NA-–∑–Ω–∞—á–µ–Ω–∏–π.

```r
checkna(weather)
```

```
##      day     hour      tem    windd    winds    rainy  clowdly       vv 
##        0        0        0        0        0        0      545        8 
## humidity      ppp     year    month 
##        4        4        0        0
```
–≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –≤–µ—Ç—Ä–∞ `windd` –µ—Å—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å "?", —Ç–∞–∫–∂–µ –µ—Å—Ç—å 4917 –ø—É—Å—Ç—ã—Ö
–∑–Ω–∞—á–µ–Ω–∏–π

```r
table(weather$windd, useNA = "ifany")
```

```
## 
##           ¬ÓÒÚÓ˜Ì˚È  «‡Ô‡‰Ì˚È       —-¬       —-«  —Â‚ÂÌ˚È       ﬁ-¬ 
##      4917      1814      3241      2519      3870      1629      3070 
##       ﬁ-«     ﬁÊÌ˚È        ?-      ????   ???????  ???????? 
##      3865      3344       104         7        55        11
```
–∑–Ω–∞—á–µ–Ω–∏—è —Å "?" –∑–∞–º–µ–Ω–∏–º –Ω–∞ NA

```r
is.na(weather$windd[grepl("\\?", weather$windd)]) <- T
```
–∑–∞–¥–∞–¥–∏–º —É—Ä–æ–≤–Ω–∏ —Ñ–∞–∫—Ç–æ—Ä–∞ –¥–ª—è `windd` (–∏ —Å–¥–µ–ª–∞–µ–º —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–º –¥–ª—è –¥–∞–ª—å–Ω.
–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏), –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ —É—Ä–æ–≤–Ω–µ–π –ø–æ–ª—É—á–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–µ NA (–≤ —Ç–æ–º —á–∏—Å–ª–µ 4917 
–ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

```r
weather$windd <- factor(x = weather$windd, levels = c("–í–æ—Å—Ç–æ—á–Ω—ã–π", "–ó–∞–ø–∞–¥–Ω—ã–π", 
                "–°-–í", "–°-–ó", "–°–µ–≤–µ—Ä–Ω—ã–π", "–Æ-–í", "–Æ-–ó", "–Æ–∂–Ω—ã–π"),ordered = T)
```
–í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ `winds` –µ—Å—Ç—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. 

```r
table(weather$winds)
```

```
## 
##     1     2     3     4     5 ÿÚËÎ¸     6     7    21     8          99 
##  9151  8206  4235  1487   329  4903    79     7     1     2     1     1 
##    60    57    30    11   ???     9 
##     1     1     1     1    39     1
```
"–®—Ç–∏–ª—å" - –∑–∞–º–µ–Ω–∏–º –Ω–∞ 0, –∑–Ω-—è –≤—ã—à–µ 21 (–∏—Ö –≤—Å–µ–≥–æ 7) –∑–∞–º–µ–Ω–∏–º –Ω–∞ NA, –∑–Ω–∞—á–µ–Ω–∏—è "???" 
(39 —à—Ç) –∑–∞–º–µ–Ω–∏–º –Ω–∞ NA

```r
weather$winds <- as.character(weather$winds)
weather$winds[grepl("–®—Ç–∏–ª—å", weather$winds)] <- "0"
is.na(weather$winds[grepl("\\?", weather$winds)]) <- T
is.na(weather$winds[weather$winds %in% c("21", "30", "57", "60", "99")]) <- T
```
–ò –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º `winds` –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç

```r
weather$winds <- as.numeric(weather$winds)
```

```
## Warning: NAs introduced by coercion
```
–í –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–¥—É—Ö–∞ `humidity` –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã

```r
head(weather$humidity[order(weather$humidity, decreasing = T)], n = 20)
```

```
##  [1] 680 174 155 148 144 136 135 133 131 127 120 119 117 115 113 110 107
## [18] 107 106 105
```
–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–µ 680 –∑–∞–º–µ–Ω–∏–º –Ω–∞ NA, –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–æ–ª—å—à–∏–µ 100 –∑–∞–º–µ–Ω–∏–º –Ω–∞ 100, 
(—É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ –æ—Ç–Ω.–≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤—ã—à–µ 100% –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö)

```r
is.na(weather[which(weather$humidity==680,arr.ind = T),"humidity"]) <- T
weather$humidity[weather$humidity>100] <- 100
```

## –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
–¢–∞–∫ –∫–∞–∫ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å –º–µ—Ç–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–π —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 3 —á–∞—Å–∞, —Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞–¥–æ —É—Å—Ä–µ–¥–Ω–∏—Ç—å - 
–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É day+year+month
–ø—Ä–∏ —ç—Ç–æ–º —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:  
 * —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ - —Å—Ä–µ–¥–Ω—è—è –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ  
 * –æ–±–ª–∞—á–Ω–æ—Å—Ç—å - —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ   
 * —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ - —Å—Ä–µ–¥–Ω—è—è –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ  
 * –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ - "–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ" –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ  
 * –≤–ª–∞–∂–Ω–æ—Å—Ç—å - —Å—Ä–µ–¥–Ω—è—è –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ  
 * –¥–∞–≤–ª–µ–Ω–∏–µ - —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ 9,12,15,18-—á–∞—Å–æ–≤—ã–µ –¥–∞–Ω–Ω–Ω—ã–µ  

```r
t1 <- subset(weather, weather$hour>=9 & weather$hour<=18)
t2 <- group_by(t1, day, month, year)
weather2 <- summarise(t2, tem=mean(tem, na.rm = T), clowdly=mean(clowdly, na.rm = T), 
                      winds=mean(winds, na.rm=T), windd=max(windd, na.rm=T),
                      humidity=mean(humidity, na.rm=T), ppp=mean(ppp, na.rm=T))
```

*–∑–∞–º–µ—á–∞–Ω–∏–µ: –±—ã–ª–æ 39 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π, –æ —Ç–æ–º, —á—Ç–æ –≤ –≥—Ä—É–ø–ø–∞—Ö –¥–ª—è windd –Ω–µ –±—ã–ª–æ* 
*–æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç NA –∑–Ω–∞—á–µ–Ω–∏–π "no non-missing arguments to max; returning -Inf" -*
*—É—Ç–æ—á–Ω–∏–ª: —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –±—É–¥—É—Ç NA*

–ø—Ä–æ–≤–µ—Ä–∫–∞ NA –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ —Ä–∞—Å—á–µ—Ç–∞ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π

```r
temp <- checkna(weather2)
```
—Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 

```
##      day    month     year      tem  clowdly    winds    windd humidity 
##        0        0        0        0       11       11     3560        0 
##      ppp 
##        0
```


## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–¥–ª—è –æ–±–ª–∞—á–Ω–æ—Å—Ç–∏ `clowdly` –¥–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç `clowdlyf` —Å 4-–º—è —É—Ä–æ–≤–Ω—è–º–∏ - —è—Å–Ω–æ, —Å—Ä–µ–¥–Ω–µ, –æ–±–ª–∞—á–Ω–æ, –ø–∞—Å–º—É—Ä–Ω–æ

```r
weather2$clowdlyf <- as.character(weather2$clowdly)
weather2$clowdlyf[(weather2$clowdly<=3) & !is.na(weather2$clowdly)]<- '—è—Å–Ω–æ'
weather2$clowdlyf[(weather2$clowdly > 3 & weather2$clowdly <= 7) & 
                    !is.na(weather2$clowdly)]<- '—Å—Ä–µ–¥–Ω–µ'
weather2$clowdlyf[(weather2$clowdly > 7 & weather2$clowdly < 9) & 
                    !is.na(weather2$clowdly)]<- '–æ–±–ª–∞—á–Ω–æ'
weather2$clowdlyf[(weather2$clowdly >= 9) & !is.na(weather2$clowdly)]<- '–ø–∞—Å–º—É—Ä–Ω–æ'
weather2$clowdlyf <- factor(weather2$clowdlyf, levels = 
                              c("–ø–∞—Å–º—É—Ä–Ω–æ", "–æ–±–ª–∞—á–Ω–æ", "—Å—Ä–µ–¥–Ω–µ", "—è—Å–Ω–æ"), ordered = T)
```

–î–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—É (–∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –î–µ–Ω—å, –ú–µ—Å—è—Ü, –≥–æ–¥) –∏ —É–¥–∞–ª—è–µ–º —Å—Ç–æ–ª–±—Ü—ã –î–µ–Ω—å, –ú–µ—Å—è—Ü,
–ì–æ–¥.


```r
weather2$date <- weather2$day
for (i in 1:nrow(weather2)) {
  t1 <- weather2[i,1]; if (nchar(t1)==1) {t1 <- paste0("0",t1)}
  t2 <- weather2[i,2]; if (nchar(t2)==1) {t2 <- paste0("0",t2)} 
  weather2[i,"date"] <- paste0(weather2[i,3],"-", t2,"-",t1)
}
weather2$date <- as.Date(weather2$date)
weather2 <- weather2[,-c(1:3)]
```

–î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å–µ–∑–æ–Ω (–∑–∏–º–∞, –ª–µ—Ç–æ, –≤–µ—Å–Ω–∞, –æ—Å–µ–Ω—å)

```r
weather2$season <- as.factor(season(weather2$date))
```
## –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
–¶–µ–ª—å –¥–∞–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ "–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å" –Ω–∞ –¥–∞–Ω–Ω—ã–µ, –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –∏–ª–∏ 
–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏.  
*—Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ 2013-2015, —Ç–æ –≤–æ–∑—å–º–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç–∏ –¥–∞—Ç—ã –∏*
*—Å–æ—Ö—Ä–∞–Ω–∏–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `weathertmp`*

```r
weathertmp <- weather2[weather2$year %in% c("2013", "2014", "2015"),]
weathertmp$year <- as.factor(weathertmp$year)
```

–ú–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ø–∞—Ä–Ω—ã—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π  

```
## Warning in min(x): no non-missing arguments to min; returning Inf
```

```
## Warning in max(x): no non-missing arguments to max; returning -Inf
```

```
## Warning in min(x): no non-missing arguments to min; returning Inf
```

```
## Warning in max(x): no non-missing arguments to max; returning -Inf
```

```
## Error in plot.window(...): ÌÛÊÌ˚ ÍÓÌÂ˜Ì˚Â ÁÌ‡˜ÂÌËˇ 'xlim'
```

![plot of chunk unnamed-chunk-26](figure/unnamed-chunk-26-1.png) 



–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è –í–ª–∞–∂–Ω–æ—Å—Ç—å ~ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞  

```r
ggplot(data = weather2, aes(x = tem, y=humidity)) + geom_point() # —Ç–µ–º–ø. –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –µ—Å—Ç—å –∫–æ—Ä—Ä
```

![plot of chunk unnamed-chunk-28](figure/unnamed-chunk-28-1.png) 

–ë–æ–∫—Å–ø–ª–æ—Ç –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ~ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞    

```r
ggplot(data = weather2, aes(x = windd, y=tem)) + geom_boxplot()
```

```
## Warning in min(x): no non-missing arguments to min; returning Inf
```

```
## Warning in max(x): no non-missing arguments to max; returning -Inf
```

```
## Warning: position_dodge requires constant width: output may be incorrect
```

```
## Error in if (zero_range(from) || zero_range(to)) {: missing value where TRUE/FALSE needed
```

–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è –î–∞–≤–ª–µ–Ω–∏–µ ~ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞  

```r
ggplot(data = weather2, aes(x = tem, y=ppp)) + geom_point()
```

![plot of chunk unnamed-chunk-30](figure/unnamed-chunk-30-1.png) 

–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è –î–∞–≤–ª–µ–Ω–∏–µ ~ –í–ª–∞–∂–Ω–æ—Å—Ç—å  

```r
ggplot(data = weather2, aes(x = humidity, y=ppp)) + geom_point()
```

![plot of chunk unnamed-chunk-31](figure/unnamed-chunk-31-1.png) 

**–í—ã–≤–æ–¥**: –∫–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –Ω–µ—Ç —è–≤–Ω—ã—Ö —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ 
–ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ –∏—Ö –±—É–¥–µ–º –≤–∫–ª—é—á–∞—Ç—å –≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º,
–¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ –≥–æ—Ç–æ–≤—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 
`weathertidy`

```r
dput(x = weather2, file = "./weathertidy")
```





