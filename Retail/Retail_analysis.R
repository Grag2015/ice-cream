
# ?????????? ?????? ???????? ?????? ddвв---------------------------------------

ggplot(retaildayli, aes(x=saleskg)) + geom_density(alpha = 0.5) + facet_grid(season ~ year, scales = "free")
ggplot(retaildayli[retaildayli$season=="spring",], aes(x=saleskg))+ geom_density(alpha = 0.5)

summary(retaildayli[retaildayli$season=="spring",]$saleskg)

# summary ? ???????? ?? ???-?????
tapply(c("autumn","winter","summer","spring"),c("autumn","winter","summer","spring"),
function(e) tapply(retaildayli[retaildayli$season==e,]$saleskg, 
                   retaildayli[retaildayli$season==e,]$year, summary))

# ??? ????????? ?-? ???? ????? ????? ??????? ?????
tapply(retaildayli$saleskg, retaildayli[,c(4,8)], min)

# ????????? ?????? ???????? ?? ????? ? ??????? 
densityplot(~saleskg | year+season, data = retaildayli, layout = c(3, 4), scales = "free", breaks = 50)



# ????????????? ?????? ----------------------------------------------------

# ?????? ????????? ?????? ? ?????
retaildayli <- dget(file = "./dump/retaildaily")

retaildayli$season <- factor(retaildayli$season)

# ????? ??????? ??.??????????? ?? ?????? :)
fit <- aov(saleskg ~ season, data = retaildayli)
summary(fit)

TukeyHSD(fit) # ???????? ????????? ??????????, ??? ??? ?????? ?????? ?????????? (?????????? ??????? ? ???? ?????-????)

# ???????? ??????????? ?? ?????-????????
bartlett.test(saleskg ~ wend, retaildayli)
fit <- aov(saleskg ~ wend, data = retaildayli)
summary(fit)
ggplot(retaildayli, aes(x=wend, y=saleskg)) + geom_boxplot( )

ggplot(retaildayli, aes(saleskg, fill = wend ))+
  geom_density(alpha = 0.5) + facet_grid(season ~ ., scales = "free")

# ???????? ??????????? ??? ??????
bartlett.test(saleskg ~ wdays, retaildayli)
fit <- aov(saleskg ~ wdays, data = retaildayli)
summary(fit)
#  ?? ???????? ????????? ?????????? ???????? ??????????? ?????? ????? ?????????? ?????
# ??-??, ??-??, ??-??, ??-??. - ?.?. ??? ??????????? saleskg ~ wdays ??? ????????? ??????? ?????? ? ??.
TukeyHSD(fit)
ggplot(retaildayli, aes(x=wdays, y=saleskg)) + geom_histogram(stat="identity") + facet_grid( season ~ .,  scales = "free")


# ??????? -----------------------------------------------------------------

ggplot(tt, aes(x=days, y=saleskg)) + geom_line( )+  facet_grid( year ~ .)

# ???????? ?? ???? ? ???????? ?? ?????
ggplot(tt, aes(x=days, y=saleskg)) + geom_line(stat="identity") + facet_grid( year ~ .)

# ?? ???? ??????

# ???????? ?????? ????????? ???????????
ggplot(tt, aes(x=saleskg)) + geom_histogram(binwidth=180)+ facet_grid( season ~ .,  scales = "free")


# Проверка требования к дисп.анализу -------------------------------------

# нормальность
# гомогенность
# 

